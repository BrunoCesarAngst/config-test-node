interface IPart {
  name: string
  description: string
}

class CreatingAPart {
  thePart: IPart

  constructor (
    private readonly creatingAPartRepository: CreatingAPartRepository,
    thePart: IPart
  ) {
    this.thePart = thePart
  }

  async create (part: string): Promise<void> {
    await this.creatingAPartRepository.create(part)
  }
}

interface CreatingAPartRepository {
  create: (part: string) => Promise<void>
  thePart: IPart

}

class CreatingAPartRepositoryMock implements CreatingAPartRepository {
  part?: string
  callsCount = 0
  thePart: IPart

  async create (part: string): Promise<void> {
    this.part = part
    this.callsCount++
  }
}

describe('CreatingAPart', () => {

  const aPart: IPart = {
    name: 'test',
    description: 'test description',
  }
  
  it('Should create a new part station', () => {
    const creatingAPartRepository = new CreatingAPartRepositoryMock()
    const sut = new CreatingAPart(creatingAPartRepository, aPart)

    expect(sut).toBeInstanceOf(CreatingAPart)
  })

  it('Should be called only once', async () => {
    const creatingAPartRepository = new CreatingAPartRepositoryMock()
    const sut = new CreatingAPart(creatingAPartRepository, aPart)

    await sut.create('part')

    expect(creatingAPartRepository.callsCount).toBe(1)
  })

  it('Should create a new part', async () => {
    const creatingAPartRepository = new CreatingAPartRepositoryMock()
    const sut = new CreatingAPart(creatingAPartRepository, aPart)

    await sut.create('part')

    expect(creatingAPartRepository.part).toBe('part')
  })
})
